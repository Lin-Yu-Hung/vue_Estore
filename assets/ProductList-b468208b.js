import{c as z,a as A,b as $,d as K,e as G}from"./api-999fccef.js";import{_ as j,I as J,J as T,K as R,l as q,r as k,q as B,C,o as h,c as b,b as e,D as V,h as l,i as I,w as D,v as O,E as y,L as p,j as N,F as E,G as F,M as X,B as Q,u as Y,z as H,p as Z,f as ee}from"./index-37c36f27.js";import{b as te}from"./bootstrap-e3c7d953.js";import{V as oe}from"./index-4ef578e3.js";import{p as ae}from"./product-bae36904.js";const se={components:{Field:J,Form:T,ErrorMessage:R},props:{setStatus:{type:String}},emits:["updateData"],setup(u,o){let w="";const{emit:t}=o,m=q();let v=k("");const c=k([]),i=k({title:"",category:"",origin_price:"",price:"",unit:"",description:"",content:"",is_enabled:1,imageUrl:v.value,imagesUrl:[...c.value]}),r=()=>{console.log(i.value),m.showLoading(),u.setStatus=="add"&&z({data:{title:"[賣]動物園造型衣服5",category:"衣服5",origin_price:100,price:300,unit:"個",description:"Sit down please 名設計師設計",content:"這是內容",is_enabled:1,imageUrl:"主圖網址",imagesUrl:["圖片網址一","圖片網址二","圖片網址三","圖片網址四","圖片網址五"]}}).then(_=>{console.log(_),w.hide(),t("updateData")}).catch(_=>{console.log(_),m.hideLoading()})},s=async a=>{const _=a.target.files.length;if(_!==0){if(m.showLoading(),_==1){const x=new FormData,L=a.target.files[0];x.append("file-to-upload",L);try{const f=await A(x);console.log(f),f.status===200&&(v.value=f.data.imageUrl)}catch(f){console.log(f)}}else{const L=[...a.target.files].map(async M=>{const P=new FormData;P.append("file-to-upload",M);const n=await A(P);return n.status===200?n.data.imageUrl:null}),f=await Promise.all(L);c.value.push(...f)}m.hideLoading()}},d=a=>{c.value=c.value.filter(_=>_!==a),document.getElementById("multipleImg")};return B(()=>{w=te("setProductModal")}),{data:i,imageUrl:v,imageList:c,setProduct:r,uploadImg:s,delImage:d}}},le={class:"modal fade modal-xl",id:"setProductModal",tabindex:"-1","aria-labelledby":"setProductModalLabel","aria-hidden":"true"},ne={class:"modal-dialog"},ie={class:"modal-content border-0"},de={class:"modal-header bg-dark text-white"},ce={class:"modal-title",id:"exampleModalLabel"},re=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),me={class:"modal-body"},ue={class:"container-fluid"},_e={class:"row"},pe={class:"col-sm-4"},ge={class:"mb-3"},he=e("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),be={class:"mb-3"},fe={for:"uploadImg",class:"form-label btn btn-primary"},ve={key:0,class:"position-relative my-2"},ye=["src","alt"],we={for:"multipleImg",class:"form-label btn btn-success"},xe={class:"container-fluid"},ke={class:"row"},Ce=["onClick"],Ve=["src","alt"],Se={class:"col-sm-8"},Le={class:"mb-3"},Pe=e("label",{for:"title",class:"form-label"},"標題",-1),Ue={class:"row gx-2"},Ie={class:"mb-3 col-md-6"},De=e("label",{for:"category",class:"form-label"},"分類",-1),Me={class:"mb-3 col-md-6"},Oe=e("label",{for:"price",class:"form-label"},"單位",-1),Ee={class:"row gx-2"},Fe={class:"mb-3 col-md-6"},Ae=e("label",{for:"origin_price",class:"form-label"},"原價",-1),He={class:"mb-3 col-md-6"},je=e("label",{for:"price",class:"form-label"},"售價",-1),qe=e("hr",null,null,-1),Be={class:"mb-3"},Ne=e("label",{for:"description",class:"form-label"},"產品描述",-1),We={class:"mb-3"},ze=e("label",{for:"content",class:"form-label"},"說明內容",-1),$e={class:"mb-3"},Ke={class:"form-check"},Ge=e("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),Je=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary px-3","data-bs-dismiss":"modal"}," 取消 "),e("button",{type:"submit",class:"btn btn-dark px-3"}," 確認 ")],-1);function Te(u,o,w,t,m,v){const c=C("font-awesome-icon"),i=C("Field"),r=C("ErrorMessage"),s=C("Form");return h(),b("div",le,[e("div",ne,[e("div",ie,[e("div",de,[e("h5",ce,[e("span",null,V(w.setStatus=="add"?"新增":"修改")+"產品",1)]),re]),e("div",me,[l(s,{class:"w-100",onSubmit:t.setProduct},{default:I(({errors:d})=>[e("div",ue,[e("div",_e,[e("div",pe,[e("div",ge,[he,D(e("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[0]||(o[0]=a=>t.imageUrl=a)},null,512),[[O,t.imageUrl]])]),e("div",be,[e("label",fe,[l(c,{icon:"fa-cloud-upload"}),y("上傳商品主圖 ")]),l(i,{name:"圖片",onChange:t.uploadImg,id:"uploadImg",class:p(["form-control d-none",{"is-invalid":d.圖片}]),type:"file",rules:{ext:["jpg","png"]}},null,8,["onChange","class"]),l(r,{class:"invalid-feedback",as:"p",name:"圖片"},{default:I(()=>[y("僅能上傳 jpg、png檔案 ")]),_:1}),t.imageUrl?(h(),b("div",ve,[e("button",{type:"button",class:"btn-close position-absolute top-0","aria-label":"Close",onClick:o[1]||(o[1]=a=>t.imageUrl="")}),e("img",{src:t.imageUrl,alt:t.imageUrl,class:"img-fluid"},null,8,ye)])):N("",!0)]),e("label",we,[l(c,{icon:"fa-file-export"}),y("上傳其他圖片")]),l(i,{name:"圖片",onChange:t.uploadImg,multiple:"",id:"multipleImg",class:p(["form-control d-none",{"is-invalid":d.圖片}]),type:"file",rules:{ext:["jpg","png"]}},null,8,["onChange","class"]),l(r,{class:"invalid-feedback",as:"p",name:"圖片"},{default:I(()=>[y("僅能上傳 jpg、png檔案 ")]),_:1}),e("div",xe,[e("div",ke,[(h(!0),b(E,null,F(t.imageList,a=>(h(),b("div",{class:"col-6 mt-2 position-relative",key:a},[e("button",{type:"button",class:"btn-close position-absolute top-0","aria-label":"Close",onClick:_=>t.delImage(a)},null,8,Ce),e("img",{src:a,alt:a,class:"img-fluid"},null,8,Ve)]))),128))])])]),e("div",Se,[e("div",Le,[Pe,l(i,{id:"title",name:"標題",type:"text",rules:"required",class:p(["formInput form-control",{"is-invalid":d.標題}]),placeHolder:"請輸入標題",modelValue:t.data.title,"onUpdate:modelValue":o[2]||(o[2]=a=>t.data.title=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"標題"})]),e("div",Ue,[e("div",Ie,[De,l(i,{id:"title",name:"分類",type:"text",rules:"required",class:p(["formInput form-control",{"is-invalid":d.分類}]),placeHolder:"請輸入分類",modelValue:t.data.category,"onUpdate:modelValue":o[3]||(o[3]=a=>t.data.category=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"分類"})]),e("div",Me,[Oe,l(i,{id:"title",name:"單位",type:"text",rules:"required",class:p(["formInput form-control",{"is-invalid":d.單位}]),placeHolder:"請輸入單位",modelValue:t.data.unit,"onUpdate:modelValue":o[4]||(o[4]=a=>t.data.unit=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"單位"})])]),e("div",Ee,[e("div",Fe,[Ae,l(i,{id:"title",name:"原價",type:"number",rules:"required",class:p(["formInput form-control",{"is-invalid":d.原價}]),placeHolder:"請輸入原價",modelValue:t.data.origin_price,"onUpdate:modelValue":o[5]||(o[5]=a=>t.data.origin_price=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"原價"})]),e("div",He,[je,l(i,{id:"title",name:"售價",type:"number",rules:"required",class:p(["formInput form-control",{"is-invalid":d.售價}]),placeHolder:"請輸入售價",modelValue:t.data.price,"onUpdate:modelValue":o[6]||(o[6]=a=>t.data.price=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"售價"})])]),qe,e("div",Be,[Ne,l(i,{as:"textarea",name:"產品描述",type:"text",rules:"required",class:p(["form-control",{"is-invalid":d.產品描述}]),placeHolder:"請輸入產品描述",modelValue:t.data.description,"onUpdate:modelValue":o[7]||(o[7]=a=>t.data.description=a)},null,8,["class","modelValue"]),l(r,{class:"text-danger invalid-feedback",name:"產品描述"})]),e("div",We,[ze,D(e("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":o[8]||(o[8]=a=>t.data.content=a)},null,512),[[O,t.data.content]])]),e("div",$e,[e("div",Ke,[D(e("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=a=>t.data.is_enabled=a)},null,512),[[X,t.data.is_enabled]]),Ge])]),Je])])])]),_:1},8,["onSubmit"])])])])])}const Re=j(se,[["render",Te]]),Xe={tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{show:!1},grid:{left:"2%",right:"6%",top:"8%",bottom:"2%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:["Brazil","Indonesia","USA","India","China","World"]},series:[{name:"2011",type:"bar",data:[18203,23489,29034,104970,131744,50230]}]},Qe={tooltip:{trigger:"item"},legend:{bottom:"center",orient:"vertical",right:"10%",selectedMode:!1},series:[{name:"Access From",type:"pie",radius:"60%",center:["35%","50%"],data:[{value:1048,name:"Search Engine"},{value:735,name:"Direct"},{value:580,name:"Email"},{value:484,name:"Union Ads"},{value:300,name:"Video Ads"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const Ye={components:{SetProductModal:Re,VueEcharts:oe},setup(){const u=ae(),{productList:o}=Q(u),w={...Xe},t={...Qe},m=k(null),v=k(""),c=k(1),i=q(),r=Y(),s=()=>{const g=window.innerHeight*.72;return Math.floor(g/60)},d=k(s()),a=H(()=>o.value?Math.ceil(Object.keys(o.value).length/d.value):0),_=H(()=>{if(o.value){const n=o.value.filter(W=>W.title.match(v.value)),g=c.value*d.value-d.value+1,U=c.value*d.value;return n.slice(g-1,U)}else return[]}),x=async()=>{i.showLoading();try{const n=await $();console.log(n),u.setProductList(Object.values(n.data.products))}catch(n){r.push("/login"),console.log(n)}finally{i.hideLoading()}},L=n=>{u.setEditData(n),r.push("/dashboard/editProduct")},f=async n=>{if(await K(n.title)){i.showLoading();try{(await G(n.id)).data.success&&await x()}catch(U){console.log(U)}finally{i.hideLoading()}}},M=n=>{c.value=n},P=()=>{const n=window.innerWidth;if(!m.value)return;const g=JSON.parse(JSON.stringify(t));n<1550&&n>1370?(g.legend.right="0%",m.value.setOption(g)):n<1370&&n>992||n<576?(g.legend={bottom:"0%",left:"center",orient:"horizontal",selectedMode:!1},g.series[0].center=["50%","45%"],m.value.setOption(g)):m.value.setOption(t)};return x(),B(()=>{P(),window.addEventListener("resize",()=>{d.value=s(),P()})}),{showData:_,pageCount:a,nowPage:c,productKeyWord:v,bestSellerOption:w,proportionOfSalesOption:t,proportionOfSales:m,getProductAll:x,deleteProduct:f,switchpage:M,setEditData:L}}},S=u=>(Z("data-v-2bdf293f"),u=u(),ee(),u),Ze={class:"container-fluid"},et={class:"row"},tt={class:"col-lg-6"},ot={class:"card shadow card-layout"},at={class:"d-column"},st=S(()=>e("p",{class:"mb-0 pb-2 border-bottom fs-large"},"熱銷商品",-1)),lt={class:"col-lg-6"},nt={class:"card shadow card-layout"},it={class:"d-column"},dt=S(()=>e("p",{class:"mb-0 pb-2 border-bottom fs-large"},"銷售額占比",-1)),ct={class:"card card-layout"},rt={class:"productList"},mt={class:"d-between"},ut={class:"border px-3 rounded-5 d-center align-items-center w-lg-25"},_t={class:"table table-hover"},pt=S(()=>e("thead",null,[e("tr",null,[e("th",{scope:"col"},"狀態"),e("th",{scope:"col",class:"mobile-hide"},"商品分類"),e("th",{scope:"col"},"商品名稱"),e("th",{scope:"col",class:"mobile-hide"},"商品原價"),e("th",{scope:"col"},"商品價格"),e("th",{scope:"col"},"操作")])],-1)),gt=S(()=>e("td",null,[e("p",{class:"fixed-width-80 status-text bg-success text-green"}," 啟用 ")],-1)),ht={class:"mobile-hide"},bt=["src","alt","title"],ft={class:"mobile-hide"},vt={class:"d-flex justify-content-center flex-wrap"},yt=["onClick"],wt=["onClick"],xt={key:0,class:"d-end me-3"},kt={"aria-label":"Page navigation example "},Ct={class:"pagination mb-0"},Vt={class:"page-item"},St=S(()=>e("span",{"aria-hidden":"true"},"«",-1)),Lt=[St],Pt=["onClick"],Ut={class:"page-item"},It=S(()=>e("span",{"aria-hidden":"true"},"»",-1)),Dt=[It];function Mt(u,o,w,t,m,v){const c=C("VueEcharts"),i=C("font-awesome-icon"),r=C("router-link");return h(),b("div",Ze,[e("div",et,[e("div",tt,[e("div",ot,[e("div",at,[st,l(c,{id:"bestSeller",option:t.bestSellerOption,style:{height:"300px",width:"100%"}},null,8,["option"])])])]),e("div",lt,[e("div",nt,[e("div",it,[dt,l(c,{ref:"proportionOfSales",option:t.proportionOfSalesOption,style:{height:"300px",width:"100%"}},null,8,["option"])])])])]),e("div",ct,[e("div",rt,[e("div",mt,[e("div",ut,[l(i,{icon:"fa-search",role:"button"}),D(e("input",{type:"text",class:"form-control border-0",placeholder:"查詢商品名稱","onUpdate:modelValue":o[0]||(o[0]=s=>t.productKeyWord=s)},null,512),[[O,t.productKeyWord]])]),l(r,{to:"setProduct",class:"bg-primary px-3 py-2 text-center rounded text-white"},{default:I(()=>[y("+ 新增")]),_:1})]),e("table",_t,[pt,e("tbody",null,[(h(!0),b(E,null,F(t.showData,s=>(h(),b("tr",{key:s.id},[gt,e("td",ht,V(s.category),1),e("td",null,[e("img",{class:"image-sm me-2",src:s.imageUrl,alt:s.title,title:s.title},null,8,bt),y(V(s.title),1)]),e("td",ft,V(s.origin_price.toLocaleString()),1),e("td",null,V(s.price.toLocaleString()),1),e("td",null,[e("div",vt,[e("button",{type:"button",class:"edit-btn",onClick:d=>t.setEditData(s)},[l(i,{icon:"fa-edit"}),y("編輯 ")],8,yt),e("button",{type:"button",class:"danger-btn",onClick:d=>t.deleteProduct(s)},[l(i,{icon:"fa-trash-can"}),y("刪除 ")],8,wt)])])]))),128))])])]),t.pageCount!==1?(h(),b("div",xt,[e("nav",kt,[e("ul",Ct,[e("li",Vt,[e("a",{class:p(["page-link",{disabled:t.nowPage==1}]),"aria-label":"Previous",onClick:o[1]||(o[1]=s=>t.nowPage--)},Lt,2)]),(h(!0),b(E,null,F(t.pageCount,(s,d)=>(h(),b("li",{class:"page-item",key:d},[e("a",{class:p(["page-link",{active:t.nowPage==s}]),onClick:a=>t.switchpage(s)},V(s),11,Pt)]))),128)),e("li",Ut,[e("a",{class:p(["page-link",{disabled:t.nowPage==t.pageCount}]),"aria-label":"Next",onClick:o[2]||(o[2]=s=>t.nowPage++)},Dt,2)])])])])):N("",!0)])])}const jt=j(Ye,[["render",Mt],["__scopeId","data-v-2bdf293f"]]);export{jt as default};
