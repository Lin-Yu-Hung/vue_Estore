import{h as z,i as j,j as G,k as K}from"./api-631ab026.js";import{_ as B,R,S as T,U as J,l as q,r as V,L as A,b as S,o as u,c as h,d as e,D as x,h as l,i as D,w as M,v as E,B as k,n as _,q as O,F,C as H,e as X,E as Q,x as Y,u as Z,y as N,G as ee,p as te,k as oe}from"./index-321b284f.js";import{a as se}from"./bootstrap-f5bfe0a4.js";import{d as ae}from"./sweetAlert-77e8855f.js";import{V as le}from"./index-a79d5b8e.js";import{p as ne}from"./product-f6674bed.js";const ie={components:{Field:R,Form:T,ErrorMessage:J},props:{setStatus:{type:String}},emits:["updateData"],setup(r,o){let b="";const{emit:t}=o,f=q();let p=V("");const m=V([]),n=V({title:"",category:"",origin_price:"",price:"",unit:"",description:"",content:"",is_enabled:1,imageUrl:p.value,imagesUrl:[...m.value]}),d=()=>{console.log(n.value),f.showLoading(),r.setStatus=="add"&&z({data:{title:"[賣]動物園造型衣服5",category:"衣服5",origin_price:100,price:300,unit:"個",description:"Sit down please 名設計師設計",content:"這是內容",is_enabled:1,imageUrl:"主圖網址",imagesUrl:["圖片網址一","圖片網址二","圖片網址三","圖片網址四","圖片網址五"]}}).then(g=>{console.log(g),b.hide(),t("updateData")}).catch(g=>{console.log(g),f.hideLoading()})},a=async s=>{const g=s.target.files.length;if(g!==0){if(f.showLoading(),g==1){const L=new FormData,C=s.target.files[0];L.append("file-to-upload",C);try{const y=await j(L);console.log(y),y.status===200&&(p.value=y.data.imageUrl)}catch(y){console.log(y)}}else{const C=[...s.target.files].map(async $=>{const U=new FormData;U.append("file-to-upload",$);const P=await j(U);return P.status===200?P.data.imageUrl:null}),y=await Promise.all(C);m.value.push(...y)}f.hideLoading()}},c=s=>{m.value=m.value.filter(g=>g!==s),document.getElementById("multipleImg")};return A(()=>{b=se("setProductModal")}),{data:n,imageUrl:p,imageList:m,setProduct:d,uploadImg:a,delImage:c}}},de={class:"modal fade modal-xl",id:"setProductModal",tabindex:"-1","aria-labelledby":"setProductModalLabel","aria-hidden":"true"},ce={class:"modal-dialog"},re={class:"modal-content border-0"},me={class:"modal-header bg-dark text-white"},ue={class:"modal-title",id:"exampleModalLabel"},_e=e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),pe={class:"modal-body"},ge={class:"container-fluid"},he={class:"row"},be={class:"col-sm-4"},fe={class:"mb-3"},ve=e("label",{for:"image",class:"form-label"},"輸入圖片網址",-1),ye={class:"mb-3"},we={for:"uploadImg",class:"form-label btn btn-primary"},xe={key:0,class:"position-relative my-2"},ke=["src","alt"],Ce={for:"multipleImg",class:"form-label btn btn-success"},Ve={class:"container-fluid"},Se={class:"row"},Le=["onClick"],Pe=["src","alt"],Ue={class:"col-sm-8"},Ie={class:"mb-3"},De=e("label",{for:"title",class:"form-label"},"標題",-1),Me={class:"row gx-2"},Oe={class:"mb-3 col-md-6"},$e=e("label",{for:"category",class:"form-label"},"分類",-1),Ee={class:"mb-3 col-md-6"},Fe=e("label",{for:"price",class:"form-label"},"單位",-1),He={class:"row gx-2"},je={class:"mb-3 col-md-6"},Ne=e("label",{for:"origin_price",class:"form-label"},"原價",-1),Be={class:"mb-3 col-md-6"},qe=e("label",{for:"price",class:"form-label"},"售價",-1),Ae=e("hr",null,null,-1),We={class:"mb-3"},ze=e("label",{for:"description",class:"form-label"},"產品描述",-1),Ge={class:"mb-3"},Ke=e("label",{for:"content",class:"form-label"},"說明內容",-1),Re={class:"mb-3"},Te={class:"form-check"},Je=e("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),Xe=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary px-3","data-bs-dismiss":"modal"}," 取消 "),e("button",{type:"submit",class:"btn btn-dark px-3"}," 確認 ")],-1);function Qe(r,o,b,t,f,p){const m=S("font-awesome-icon"),n=S("Field"),d=S("ErrorMessage"),a=S("Form");return u(),h("div",de,[e("div",ce,[e("div",re,[e("div",me,[e("h5",ue,[e("span",null,x(b.setStatus=="add"?"新增":"修改")+"產品",1)]),_e]),e("div",pe,[l(a,{class:"w-100",onSubmit:t.setProduct},{default:D(({errors:c})=>[e("div",ge,[e("div",he,[e("div",be,[e("div",fe,[ve,M(e("input",{type:"text",class:"form-control",id:"image",placeholder:"請輸入圖片連結","onUpdate:modelValue":o[0]||(o[0]=s=>t.imageUrl=s)},null,512),[[E,t.imageUrl]])]),e("div",ye,[e("label",we,[l(m,{icon:"fa-cloud-upload"}),k("上傳商品主圖 ")]),l(n,{name:"圖片",onChange:t.uploadImg,id:"uploadImg",class:_(["form-control d-none",{"is-invalid":c.圖片}]),type:"file",rules:{ext:["jpg","png"]}},null,8,["onChange","class"]),l(d,{class:"invalid-feedback",as:"p",name:"圖片"},{default:D(()=>[k("僅能上傳 jpg、png檔案 ")]),_:1}),t.imageUrl?(u(),h("div",xe,[e("button",{type:"button",class:"btn-close position-absolute top-0","aria-label":"Close",onClick:o[1]||(o[1]=s=>t.imageUrl="")}),e("img",{src:t.imageUrl,alt:t.imageUrl,class:"img-fluid"},null,8,ke)])):O("",!0)]),e("label",Ce,[l(m,{icon:"fa-file-export"}),k("上傳其他圖片")]),l(n,{name:"圖片",onChange:t.uploadImg,multiple:"",id:"multipleImg",class:_(["form-control d-none",{"is-invalid":c.圖片}]),type:"file",rules:{ext:["jpg","png"]}},null,8,["onChange","class"]),l(d,{class:"invalid-feedback",as:"p",name:"圖片"},{default:D(()=>[k("僅能上傳 jpg、png檔案 ")]),_:1}),e("div",Ve,[e("div",Se,[(u(!0),h(F,null,H(t.imageList,s=>(u(),h("div",{class:"col-6 mt-2 position-relative",key:s},[e("button",{type:"button",class:"btn-close position-absolute top-0","aria-label":"Close",onClick:g=>t.delImage(s)},null,8,Le),e("img",{src:s,alt:s,class:"img-fluid"},null,8,Pe)]))),128))])])]),e("div",Ue,[e("div",Ie,[De,l(n,{id:"title",name:"標題",type:"text",rules:"required",class:_(["formInput form-control",{"is-invalid":c.標題}]),placeHolder:"請輸入標題",modelValue:t.data.title,"onUpdate:modelValue":o[2]||(o[2]=s=>t.data.title=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"標題"})]),e("div",Me,[e("div",Oe,[$e,l(n,{id:"title",name:"分類",type:"text",rules:"required",class:_(["formInput form-control",{"is-invalid":c.分類}]),placeHolder:"請輸入分類",modelValue:t.data.category,"onUpdate:modelValue":o[3]||(o[3]=s=>t.data.category=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"分類"})]),e("div",Ee,[Fe,l(n,{id:"title",name:"單位",type:"text",rules:"required",class:_(["formInput form-control",{"is-invalid":c.單位}]),placeHolder:"請輸入單位",modelValue:t.data.unit,"onUpdate:modelValue":o[4]||(o[4]=s=>t.data.unit=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"單位"})])]),e("div",He,[e("div",je,[Ne,l(n,{id:"title",name:"原價",type:"number",rules:"required",class:_(["formInput form-control",{"is-invalid":c.原價}]),placeHolder:"請輸入原價",modelValue:t.data.origin_price,"onUpdate:modelValue":o[5]||(o[5]=s=>t.data.origin_price=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"原價"})]),e("div",Be,[qe,l(n,{id:"title",name:"售價",type:"number",rules:"required",class:_(["formInput form-control",{"is-invalid":c.售價}]),placeHolder:"請輸入售價",modelValue:t.data.price,"onUpdate:modelValue":o[6]||(o[6]=s=>t.data.price=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"售價"})])]),Ae,e("div",We,[ze,l(n,{as:"textarea",name:"產品描述",type:"text",rules:"required",class:_(["form-control",{"is-invalid":c.產品描述}]),placeHolder:"請輸入產品描述",modelValue:t.data.description,"onUpdate:modelValue":o[7]||(o[7]=s=>t.data.description=s)},null,8,["class","modelValue"]),l(d,{class:"text-danger invalid-feedback",name:"產品描述"})]),e("div",Ge,[Ke,M(e("textarea",{type:"text",class:"form-control",id:"content",placeholder:"請輸入產品說明內容","onUpdate:modelValue":o[8]||(o[8]=s=>t.data.content=s)},null,512),[[E,t.data.content]])]),e("div",Re,[e("div",Te,[M(e("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":o[9]||(o[9]=s=>t.data.is_enabled=s)},null,512),[[X,t.data.is_enabled]]),Je])]),Xe])])])]),_:1},8,["onSubmit"])])])])])}const Ye=B(ie,[["render",Qe]]),Ze={tooltip:{trigger:"axis",axisPointer:{type:"shadow"},formatter:r=>{const o=r[0];return`
            ${o.marker}<span class="fw-bold">${o.seriesName}</span><br /> 
            ${o.name} : <span class="fw-bold">${o.value.toLocaleString()} 元</span>
            `}},legend:{show:!1},grid:{left:"2%",right:"6%",top:"8%",bottom:"2%",containLabel:!0},xAxis:{type:"value",boundaryGap:[0,.01]},yAxis:{type:"category",data:["Game Console","Smartphone","Computer","Smartwatch","Headphones","MacBook"]},series:[{name:"2024",type:"bar",data:[18203,23489,29034,50230,104970,131744]}]},et={tooltip:{trigger:"item",formatter:r=>`
            ${r.marker}<span class="fw-bold">${r.seriesName}</span><br /> 
            ${r.name} : <span class="fw-bold">${r.percent} %</span>
            `},legend:{bottom:"center",orient:"vertical",right:"10%",selectedMode:!1},series:[{name:"銷售額占比",type:"pie",radius:"60%",center:["35%","50%"],data:[{value:1048,name:"手機"},{value:735,name:"平板"},{value:580,name:"筆記型電腦"},{value:484,name:"3C產品"},{value:300,name:"智慧手錶"}],emphasis:{itemStyle:{shadowBlur:10,shadowOffsetX:0,shadowColor:"rgba(0, 0, 0, 0.5)"}}}]};const tt={components:{SetProductModal:Ye,VueEcharts:le},setup(){const r=Q("isVisitor"),o=ne(),{productList:b}=Y(o),t={...Ze},f={...et},p=V(null),m=V(""),n=V(1),d=q(),a=Z(),c=()=>{const v=window.innerHeight*.72;return Math.floor(v/60)},s=V(c()),g=N(()=>b.value?Math.ceil(Object.keys(b.value).length/s.value):0),L=N(()=>{if(b.value){const i=b.value.filter(W=>W.title.match(m.value)),v=n.value*s.value-s.value+1,I=n.value*s.value;return i.slice(v-1,I)}else return[]}),C=async()=>{d.showLoading();try{const i=await G();console.log(i),o.setProductList(Object.values(i.data.products))}catch(i){a.push("/login"),console.log(i)}finally{d.hideLoading()}},y=i=>{o.setEditData(i),a.push("/dashboard/editProduct")},$=async i=>{if(await ae(i.title)){d.showLoading();try{(await K(i.id)).data.success&&await C()}catch(I){console.log(I)}finally{d.hideLoading()}}},U=i=>{n.value=i},P=()=>{const i=window.innerWidth;if(!p.value)return;const v=JSON.parse(JSON.stringify(f));i<1550&&i>1370?(v.legend.right="0%",p.value.setOption(v)):i<1370&&i>992||i<576?(v.legend={bottom:"0%",left:"center",orient:"horizontal",selectedMode:!1},v.series[0].center=["50%","45%"],p.value.setOption(v)):p.value.setOption(f)};return C(),A(()=>{P(),window.addEventListener("resize",()=>{s.value=c(),P()})}),{showData:L,pageCount:g,nowPage:n,productKeyWord:m,bestSellerOption:t,proportionOfSalesOption:f,proportionOfSales:p,getProductAll:C,deleteProduct:$,switchpage:U,setEditData:y,isVisitor:r}}},w=r=>(te("data-v-e536b601"),r=r(),oe(),r),ot={class:"container-fluid"},st={class:"row"},at={class:"col-lg-6"},lt={class:"card shadow card-layout"},nt={class:"d-column"},it=w(()=>e("p",{class:"mb-0 pb-2 border-bottom fs-large"},"熱銷商品",-1)),dt={class:"col-lg-6"},ct={class:"card shadow card-layout"},rt={class:"d-column"},mt=w(()=>e("p",{class:"mb-0 pb-2 border-bottom fs-large"},"銷售額占比",-1)),ut={class:"card card-layout"},_t={class:"productList"},pt={class:"d-between"},gt={class:"border px-3 rounded-5 d-center align-items-center w-lg-25"},ht={class:"table table-hover"},bt=w(()=>e("th",{scope:"col"},"狀態",-1)),ft=w(()=>e("th",{scope:"col",class:"mobile-hide"},"商品分類",-1)),vt=w(()=>e("th",{scope:"col"},"商品名稱",-1)),yt=w(()=>e("th",{scope:"col",class:"mobile-hide text-end"},"商品原價",-1)),wt=w(()=>e("th",{scope:"col",class:"text-end"},"商品價格",-1)),xt={scope:"col"},kt={class:"mobile-hide"},Ct=["src","alt","title"],Vt={class:"mobile-hide text-end"},St={class:"text-end"},Lt={key:0,class:"d-flex justify-content-center flex-wrap"},Pt=["onClick"],Ut=["onClick"],It={key:0,class:"d-end me-3"},Dt={"aria-label":"Page navigation example "},Mt={class:"pagination mb-0"},Ot={class:"page-item"},$t=w(()=>e("span",{"aria-hidden":"true"},"«",-1)),Et=[$t],Ft=["onClick"],Ht={class:"page-item"},jt=w(()=>e("span",{"aria-hidden":"true"},"»",-1)),Nt=[jt];function Bt(r,o,b,t,f,p){const m=S("VueEcharts"),n=S("font-awesome-icon"),d=S("router-link");return u(),h("div",ot,[e("div",st,[e("div",at,[e("div",lt,[e("div",nt,[it,l(m,{id:"bestSeller",option:t.bestSellerOption,style:{height:"300px",width:"100%"}},null,8,["option"])])])]),e("div",dt,[e("div",ct,[e("div",rt,[mt,l(m,{ref:"proportionOfSales",option:t.proportionOfSalesOption,style:{height:"300px",width:"100%"}},null,8,["option"])])])])]),e("div",ut,[e("div",_t,[e("div",pt,[e("div",gt,[l(n,{icon:"fa-search",role:"button"}),M(e("input",{type:"text",class:"form-control border-0",placeholder:"查詢商品名稱","onUpdate:modelValue":o[0]||(o[0]=a=>t.productKeyWord=a)},null,512),[[E,t.productKeyWord]])]),t.isVisitor?O("",!0):(u(),ee(d,{key:0,to:"setProduct",class:"bg-primary px-3 py-2 text-center rounded text-white"},{default:D(()=>[k("+ 新增")]),_:1}))]),e("table",ht,[e("thead",null,[e("tr",null,[bt,ft,vt,yt,wt,e("th",xt,x(t.isVisitor?"":"操作"),1)])]),e("tbody",null,[(u(!0),h(F,null,H(t.showData,a=>(u(),h("tr",{key:a.id},[e("td",null,[e("p",{class:_(["fixed-width-80 status-text",{"bg-success text-green":a.is_enabled===1,"bg-red text-white":a.is_enabled!==1}])},x(a.is_enabled===1?"啟用":"未啟用"),3)]),e("td",kt,x(a.category),1),e("td",null,[e("img",{class:"image-mini me-2",src:a.imageUrl,alt:a.title,title:a.title},null,8,Ct),k(x(a.title),1)]),e("td",Vt,x(a.origin_price.toLocaleString()),1),e("td",St,x(a.price.toLocaleString()),1),e("td",null,[t.isVisitor?O("",!0):(u(),h("div",Lt,[e("button",{type:"button",class:"edit-btn",onClick:c=>t.setEditData(a)},[l(n,{icon:"fa-edit"}),k("編輯 ")],8,Pt),e("button",{type:"button",class:"danger-btn",onClick:c=>t.deleteProduct(a)},[l(n,{icon:"fa-trash-can"}),k("刪除 ")],8,Ut)]))])]))),128))])])]),t.pageCount!==1?(u(),h("div",It,[e("nav",Dt,[e("ul",Mt,[e("li",Ot,[e("a",{class:_(["page-link",{disabled:t.nowPage==1}]),"aria-label":"Previous",onClick:o[1]||(o[1]=a=>t.nowPage--)},Et,2)]),(u(!0),h(F,null,H(t.pageCount,(a,c)=>(u(),h("li",{class:"page-item",key:c},[e("a",{class:_(["page-link",{active:t.nowPage==a}]),onClick:s=>t.switchpage(a)},x(a),11,Ft)]))),128)),e("li",Ht,[e("a",{class:_(["page-link",{disabled:t.nowPage==t.pageCount}]),"aria-label":"Next",onClick:o[2]||(o[2]=a=>t.nowPage++)},Nt,2)])])])])):O("",!0)])])}const Rt=B(tt,[["render",Bt],["__scopeId","data-v-e536b601"]]);export{Rt as default};
