import{_ as V,r as v,b as U,o as a,G as N,l as T,y as B,c as l,d as t,h as f,B as w,w as u,v as b,F as k,C as M,q as S,n as C,D as r,e as W,p as K,k as j}from"./index-321b284f.js";import{n as q,o as F,p as G}from"./api-631ab026.js";import{t as J}from"./date-44c8fab1.js";import{d as Y,s as z,e as E}from"./sweetAlert-77e8855f.js";import{c as P}from"./bootstrap-f5bfe0a4.js";const R={props:{sortList:{type:Array,default:[]},sortItem:{type:String,default:""}},setup(c,s){const m=v("fa-arrow-up-wide-short");return{icon:m,toggleIcon:()=>{m.value=m.value==="fa-arrow-up-wide-short"?"fa-arrow-down-short-wide":"fa-arrow-up-wide-short";const h=m.value==="fa-arrow-up-wide-short"?"up":"down";c.sortItem&&c.sortList.sort((p,_)=>h==="up"?_[c.sortItem]-p[c.sortItem]:p[c.sortItem]-_[c.sortItem])}}}};function H(c,s,m,e,h,p){const _=U("font-awesome-icon");return a(),N(_,{icon:e.icon,role:"button",onClick:e.toggleIcon},null,8,["icon","onClick"])}const Q=V(R,[["render",H]]);const X={components:{DataSortIcon:Q},setup(){const c=T(),s=v([]),m=v(""),e=v({}),h=v({}),p=v(0),_=v(""),g=async(n=1)=>{try{c.showLoading();const d=await q(n);console.log(d),d.data.success&&(s.value=[...d.data.orders],e.value={...d.data.pagination})}catch(d){console.log(d)}finally{c.hideLoading()}},D=(n,d="view")=>{if(_.value=d,h.value=JSON.parse(JSON.stringify(n)),d==="view"){const O=Object.entries(n.products).reduce((x,A)=>(x+=A[1].total,x),0);p.value=O-n.total}},I=B(()=>s.value.filter(n=>n.id.match(m.value))),y=async(n,d,O)=>{try{c.showLoading(),(await n(...d)).status===200&&(await g(e.value.current_page),P("exampleModal"),z(`${O}成功`)),c.hideLoading()}catch(x){E("發生錯誤!"),console.log(x)}},L=async n=>{await Y(n.id)&&y(F,[n.id],"刪除")},o=async()=>{y(G,[h.value.id,{data:h.value}],"修改")};return g(1),{showData:I,pageInfo:e,timestampToYMD:J,orderKeyWord:m,getOrderList:g,orderList:s,orderDetail:h,setOrderDetail:D,orderDiscount:p,deleteOrder:L,modalMode:_,UpdateOrder:o}}},i=c=>(K("data-v-9b23b2ba"),c=c(),j(),c),Z={class:"container-fluid"},$={class:"d-between align-items-center"},tt={class:"fs-5"},et={class:"border px-3 rounded-5 d-center align-items-center w-25 my-2"},ot={key:0,class:"card shadow table-responsive"},st={class:"table"},at={class:"bg-light"},lt=i(()=>t("th",{scope:"col",class:"mobile-hide"},null,-1)),nt={scope:"col"},dt=i(()=>t("th",{scope:"col",class:"text-center"},"是否付款",-1)),it=i(()=>t("th",{scope:"col",class:"mobile-hide"},"訂單編號",-1)),ct={scope:"col",class:"text-end mobile-hide"},rt=i(()=>t("th",{scope:"col",class:"text-end"},"詳細資料",-1)),_t=i(()=>t("th",{scope:"col",class:"text-center"},"操作",-1)),mt=i(()=>t("td",{class:"mobile-hide"},null,-1)),ht={scope:"col",class:"text-center"},pt={class:"mobile-hide"},ut={class:"text-end mobile-hide"},vt={class:"text-end"},gt=["onClick"],ft={class:"d-flex justify-content-center flex-wrap"},bt=["onClick"],yt=["onClick"],xt={key:1,"aria-label":"Page navigation example",class:"mt-3 d-end"},wt={class:"pagination"},kt=i(()=>t("a",{class:"page-link"},"上一頁",-1)),Dt=[kt],It=["onClick"],Lt={class:"page-link"},Ct=i(()=>t("a",{class:"page-link"},"下一頁",-1)),Ot=[Ct],Mt={class:"modal fade",id:"exampleModal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},St={class:"modal-dialog modal-dialog-centered modal-md"},Ut={class:"modal-content"},Vt=i(()=>t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"詳細資訊"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1)),At={class:"modal-body"},Nt=i(()=>t("h2",{class:"fs-5 border-bottom pb-3"},"訂貨人資訊",-1)),Tt={key:0,class:"container-fluid"},Bt={class:"row g-3 text-nowrap"},Wt={class:"col-md-6"},Kt={class:"row align-items-center"},jt=i(()=>t("div",{class:"col-3 col-md"},"姓名",-1)),qt={class:"col"},Ft={key:0},Gt={class:"col-md-6"},Jt={class:"row align-items-center"},Yt=i(()=>t("div",{class:"col-3 col-md-5 text-md-end"},"電話",-1)),zt={class:"col"},Et={key:0},Pt={class:"col-12"},Rt={class:"row align-items-center"},Ht=i(()=>t("div",{class:"col-3"},"地址",-1)),Qt={class:"col"},Xt={key:0},Zt={class:"col-12"},$t={class:"row align-items-center"},te=i(()=>t("div",{class:"col-3"},"電子信箱",-1)),ee={class:"col"},oe={key:0},se={class:"col-12"},ae={class:"row align-items-center"},le=i(()=>t("div",{class:"col-3"},"備註",-1)),ne={class:"col"},de={key:0},ie={class:"col-12"},ce={class:"row align-items-center"},re=i(()=>t("div",{class:"col-3"},"是否付款",-1)),_e={class:"col"},me={key:0},he=i(()=>t("h2",{class:"fs-5 border-bottom py-3 mt-3"},"商品資訊",-1)),pe={class:"table"},ue=i(()=>t("thead",null,[t("tr",null,[t("th",{scope:"col"},"商品名稱"),t("th",{scope:"col",class:"text-nowrap text-end"},"數量"),t("th",{scope:"col",class:"text-end"},"單價")])],-1)),ve={class:"text-end"},ge={class:"text-end"},fe={class:"text-end text-small text-secondary"},be={class:"fs-5 text-end"},ye={key:2,class:"d-end mt-3"};function xe(c,s,m,e,h,p){var D,I,y,L;const _=U("font-awesome-icon"),g=U("DataSortIcon");return a(),l(k,null,[t("div",Z,[t("div",$,[t("h2",tt,[f(_,{icon:"fa-file-lines",role:"button",class:"text-secondary me-2 ms-1"}),w("訂單列表 ")]),t("div",et,[f(_,{icon:"fa-search",role:"button"}),u(t("input",{type:"text",class:"form-control form-control-sm border-0",placeholder:"查詢訂單編號","onUpdate:modelValue":s[0]||(s[0]=o=>e.orderKeyWord=o)},null,512),[[b,e.orderKeyWord]])])]),e.showData.length>0?(a(),l("div",ot,[t("table",st,[t("thead",null,[t("tr",at,[lt,t("th",nt,[w(" 建立日期 "),f(g,{sortList:e.orderList,sortItem:"create_at"},null,8,["sortList"])]),dt,it,t("th",ct,[w(" 訂單金額 "),f(g,{sortList:e.orderList,sortItem:"total"},null,8,["sortList"])]),rt,_t])]),t("tbody",null,[(a(!0),l(k,null,M(e.showData,o=>{var n;return a(),l("tr",{key:o.id},[mt,t("td",null,r(e.timestampToYMD(o.create_at)),1),t("td",ht,[t("p",{class:C(["fixed-width-80 status-text text-center",{"bg-success text-green":o.is_paid,"bg-red text-white":!o.is_paid}])},r(o.is_paid?"已付款":"尚未付款"),3)]),t("td",pt,r(o.id),1),t("td",ut,r((n=o.total)==null?void 0:n.toLocaleString()),1),t("td",vt,[t("span",{"data-bs-toggle":"modal","data-bs-target":"#exampleModal",class:"text-underline-hover text-link",onClick:d=>e.setOrderDetail(o)}," 詳細資料 ",8,gt)]),t("td",null,[t("div",ft,[t("button",{type:"button",class:"edit-btn","data-bs-toggle":"modal","data-bs-target":"#exampleModal",onClick:d=>e.setOrderDetail(o,"edit")},[f(_,{icon:"fa-edit"}),w("編輯 ")],8,bt),t("button",{type:"button",class:"danger-btn",onClick:d=>e.deleteOrder(o)},[f(_,{icon:"fa-trash-can"}),w("刪除 ")],8,yt)])])])}),128))])])])):S("",!0),e.pageInfo.total_pages>1?(a(),l("nav",xt,[t("ul",wt,[t("li",{class:C(["page-item",{invisible:!e.pageInfo.has_pre}]),onClick:s[1]||(s[1]=o=>e.getOrderList(--e.pageInfo.current_page))},Dt,2),(a(!0),l(k,null,M(e.pageInfo.total_pages,o=>(a(),l("li",{class:C(["page-item",{active:e.pageInfo.current_page===o}]),key:o,onClick:n=>e.getOrderList(o)},[t("a",Lt,r(o),1)],10,It))),128)),t("li",{class:C(["page-item",{invisible:!e.pageInfo.has_next}]),onClick:s[2]||(s[2]=o=>e.getOrderList(++e.pageInfo.current_page))},Ot,2)])])):S("",!0)]),t("div",Mt,[t("div",St,[t("div",Ut,[Vt,t("div",At,[Nt,e.orderDetail.user?(a(),l("div",Tt,[t("div",Bt,[t("div",Wt,[t("div",Kt,[jt,t("div",qt,[e.modalMode==="view"?(a(),l("span",Ft,r((D=e.orderDetail.user)==null?void 0:D.name),1)):u((a(),l("input",{key:1,type:"text",class:"form-control form-control-sm",placeholder:"姓名","onUpdate:modelValue":s[3]||(s[3]=o=>e.orderDetail.user.name=o)},null,512)),[[b,e.orderDetail.user.name]])])])]),t("div",Gt,[t("div",Jt,[Yt,t("div",zt,[e.modalMode==="view"?(a(),l("span",Et,r((I=e.orderDetail.user)==null?void 0:I.tel),1)):u((a(),l("input",{key:1,type:"tel",class:"form-control form-control-sm",placeholder:"電話","onUpdate:modelValue":s[4]||(s[4]=o=>e.orderDetail.user.tel=o)},null,512)),[[b,e.orderDetail.user.tel]])])])]),t("div",Pt,[t("div",Rt,[Ht,t("div",Qt,[e.modalMode==="view"?(a(),l("span",Xt,r((y=e.orderDetail.user)==null?void 0:y.address),1)):u((a(),l("input",{key:1,type:"text",class:"form-control form-control-sm",placeholder:"地址","onUpdate:modelValue":s[5]||(s[5]=o=>e.orderDetail.user.address=o)},null,512)),[[b,e.orderDetail.user.address]])])])]),t("div",Zt,[t("div",$t,[te,t("div",ee,[e.modalMode==="view"?(a(),l("span",oe,r((L=e.orderDetail.user)==null?void 0:L.email),1)):u((a(),l("input",{key:1,type:"email",class:"form-control form-control-sm",placeholder:"電子信箱","onUpdate:modelValue":s[6]||(s[6]=o=>e.orderDetail.user.email=o)},null,512)),[[b,e.orderDetail.user.email]])])])]),t("div",se,[t("div",ae,[le,t("div",ne,[e.modalMode==="view"?(a(),l("span",de,r(e.orderDetail.message),1)):u((a(),l("input",{key:1,type:"text",class:"form-control form-control-sm",placeholder:"備註","onUpdate:modelValue":s[7]||(s[7]=o=>e.orderDetail.message=o)},null,512)),[[b,e.orderDetail.message]])])])]),t("div",ie,[t("div",ce,[re,t("div",_e,[e.modalMode==="view"?(a(),l("span",me,r(e.orderDetail.is_paid?"是":"否"),1)):u((a(),l("input",{key:1,class:"form-check-input",type:"checkbox",id:"flexCheckDefault","onUpdate:modelValue":s[8]||(s[8]=o=>e.orderDetail.is_paid=o)},null,512)),[[W,e.orderDetail.is_paid]])])])])])])):S("",!0),e.modalMode==="view"?(a(),l(k,{key:1},[he,t("table",pe,[ue,t("tbody",null,[(a(!0),l(k,null,M(e.orderDetail.products,o=>{var n,d;return a(),l("tr",{key:o.id},[t("td",null,r((n=o.product)==null?void 0:n.title),1),t("td",ve,r(o.qty),1),t("td",ge,r((d=o.total)==null?void 0:d.toLocaleString()),1)])}),128))])]),t("p",fe," 折扣："+r(e.orderDiscount),1),t("h2",be,"總金額："+r(e.orderDetail.total),1)],64)):(a(),l("div",ye,[t("button",{class:"btn btn-primary-light px-4",onClick:s[9]||(s[9]=(...o)=>e.UpdateOrder&&e.UpdateOrder(...o))}," 儲存 ")]))])])])])],64)}const Ce=V(X,[["render",xe],["__scopeId","data-v-9b23b2ba"]]);export{Ce as default};
